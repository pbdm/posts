# C++

## 历史版本

* C++ 98
* C++ 03
* C++ 11
* C++ 14
* C++ 17

## VS C

* 一个 “+” 代表了 C++ 比 C 语言多出来的体现面向对象思想的类机制
* 另一个 “+” 代表了 C++ 全新添加的标准模板库

## 基本概念

* 句柄(handler): 一个数字, 和对象一一对应, 可以理解句柄是指向指针的指针.
  * 指针直接和内存打交道, 句柄和操作系统打交道
* 内存分配
  * 堆区(heap): alloc 人肉分配, 速度较慢, 容易产生内存碎片, 但是用起来方便
  * 栈区(stack): 系统分配, 速度较快, 不会产生内存碎片, 先进后出

## 常用符号

* `::` 范围解析运算符
  * 用于 namespace
  * 用于类的静态成员(static)
* 成员访问运算符
  * `->` 类指针访问成员
  * `.` 类实例访问成员
* `~` 定义析构函数
* auto: 自动推断变量类型, ~~从 C++ 17 开始不再是存储类说明~~
* 存储类: 用于控制对象的生存期, 链接和内存位置
  * static: 在程序的生命周期内保持局部变量的存在, 可以通过 `::` 定义
  * extern: 提供一个全局变量的引用, 对所有程序文件可见(相当于 JS 里的 global?)
  * thread_local: 变量仅可在它在其上创建额线程上可访问
* 避免同一头文件被 include 多次的两种方法
  * `#pragma once`
  * `#ifndef`,`#define`,`#endif` 配合
* `using`: 别名
* `typedef`: 自定义类型名

## 智能指针

为了解决内存泄露问题引入, 有了这些就可以少用 `new` 了

* `std::unique_ptr`
  * 一个资源只能被一个指针占有, 离开作用域时指向的内容自释放
* `std::shared_ptr`
  * 一个资源可以被多个指针占有, 通过引用计数管理对象
* `std::weak_ptr`
  * 用于解决“引用计数”模型循环依赖问题, weak_ptr 指向一个对象, 并不增减该对象的引用计数器(我指向这东西, 但这东西什么时候释放不关我事儿……)

## 模板(Template)

类似于泛型, 可以用于函数和类. 和重载函数一起使用时, 会优先调用匹配的重载函数

```cpp
// 函数模板定义
template <typename T>
// 类模板定义
template <class 类型参数名>
```

## Misc

* Lambda 表达式: 匿名函数, 可以作为函数参数传递
* STL: Standard Template Library, 标准模板库, 通过模板提供了一些现成的算法和工具函数
* RAII: Resource Acquisition Is Initialization, 资源获取就是初始化, 并保证在析构的时候释放资源, 从而避免内存泄露(和 componentWillUnmount 里 removeEventListener 有点像
* MAC 全局 include 路径: `/usr/local/include`
* 编译产物
  * `.o`: 一个 `.c` 或 `.cpp` 文件编译后对应一个 `.o` 文件的二进制文件
  * `.a`: 是好多个 `.o` 合在一起, 用于静态连接, 即 STATIC mode, 多个. a 可以链接生成一个exe的可执行文件
  * .so 是 shared object, 用于动态连接的, 和 windows 的 dll 差不多, 使用时才载入

## 编译器

* Clang
  * clang for C, clang++ for C++
  * 一个 LLVM 的前端
  * 貌似比下面两个都要好用
  * libc++ 是针对 clang 特别重写的 C++ 标准库
* gcc
  * GNU Compiler Collection，GNU编译器套装, linux 默认
  * g++ for C++
    * `-x`: 选择是 c 还是 c++ 模式
  * gcc for C
* MSVC: Window 默认

## CMake

Mac 下可通过 brew 快速安装, [这篇](https://www.hahack.com/codes/cmake/)文章简单的介绍了下用法

## Debug 工具

* LLDB
* GDB

> [C++ 语言参考 in Visual Studio 2019](https://docs.microsoft.com/zh-cn/cpp/cpp/cpp-language-reference?view=vs-2019)
>
> [C++ 教程](http://www.runoob.com/cplusplus/cpp-tutorial.html)
>
> [你好，C++ 知乎专栏](https://zhuanlan.zhihu.com/nihaoCPP)